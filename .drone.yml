kind: pipeline
name: default

steps:
  - name: build
    image: plugins/hugo:latest
    environment:
      PLUGIN_HUGO_VERSION: 0.53
  - name: index
    image: node
    commands:
      - npm install
      - npm run algolia
  - name: publish_site
    image: cschlosser/drone-ftps
    environment:
      FTP_USERNAME:
        from_secret: ftp_username
      FTP_PASSWORD:
        from_secret: ftp_password
      PLUGIN_HOSTNAME: jeremybise.com:21
      PLUGIN_SECURE: false
      PLUGIN_VERIFY: false
      PLUGIN_SRC_DIR: /public
      PLUGIN_DEST_DIR: /httpdocs
      PLUGIN_CLEAN_DIR: true
